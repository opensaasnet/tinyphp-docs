语言编码
====

本规范遵守psr-4规范   
良好的代码规范并自觉严格遵守，是程序员的基本素质和团队协作的基础。

文件结构
----
-----

### 文件类型   
在.php文件里，框架设定承载内容的文件主要有五种:`包文件`、`类文件`、`函数文件`、`配置文件`，`程序执行文件`。

#### 包文件(package)  

文件包含一个或多个命名空间，每个命名空间里可有多个常量、函数和类。  
包文件以命名空间的名称命名，`遵循驼峰命名方式，首字母大写`，`存在多个命名空间时，必须包含相同的命名空间前缀`。  
 例： 命名空间tiny.Configuration的包文件为Tiny/Config.php

#### 类文件: 
以一文件一类的形式编写，文件名与类名保持一致，`遵循驼峰命名方式，首字母需大写`    
例: PublicController.php。

#### 函数文件: 
函数文件一般指全局函数的集合文件，在面向对象的PHP框架里，应尽量避免使用。   
命名方式`遵循驼峰命名方式，首字母小写`，如果存在多个同系列的函数，需采取相同的前缀或后缀, 例：    

```php
function getCookie($key);
...
function setCookie($key, $value);
```

#### 配置文件
文件名需与返回数组名保持一致，`不采用驼峰方式命名，以全小写加_分隔符方式`。
    
```php
$default = include './default.php'。
```

default.php   

```php
return [
    'name' => 'tinyphp';
];
```

default.php   

```php
$default = [];
$default['name'] = 'tinyphp';
```

#### 程序执行文件
`不采用驼峰方式命名，以全小写加_分隔符方式`。   
 例: 框架入口文件       
```php
php public/index.php
```

### 版权和版本声明

版权和版本的声明位于头文件和定义文件的开头（参见示例1-1），主要内容有：    
   - (1)版权信息。   
   - (2)文件名称，标识符，摘要。   
   - (3)当前版本号，作者/修改者，完成日期。   
   - (4)版本历史信息。   

示例 1-1:   
```php
/**
*
* [填写文件内容简介]
* 
* @Copyright (C), 2011-2012, XX公司, da.jin@tinyphp.org
* @Name [文件名]
* @Author [coder name]
* @Version Beta 1.0
* @Date Sun Dec 25 23:35:04 CST 2011
* @Class List:
*     1.  [填写Class列表简介]
* @Function List:
*     1.    [填写Function列表简介]
* @History
*     <author>    <time>                        <version >   <desc>
*       [coder]      当前日期时间，以GMT标准格式填写           第一次建立该文件
*/
```
 
### 包和类文件

包文件和类文件主要有三部分内容：
    * 定义文件开头处的版权和版本声明（参见示例1-1）。   
    * 对一些命名空间和类的引用。   
    * 程序实现（包括数据和代码)。  
    * 假设控制器文件的名称为 `MainController.php`, 我们定义文件的结构参见示例1-2。    

示例 1-2:   

```php
<?php

// 版权和版本声明见示例1-1，此处省略。

namespace App\Controller;  // 命名空间

use Tiny\MVC\Controller\Controller; // 引用的类

 // 类的实现体
class MainController extend Controller
{
    public function indexAction(…)
    {
        ... 
    }
}
```

程序排版
----
-----

### 空行

空行起着分隔程序段落的作用。

    * `【规则2-1-1】`在每个类声明之后、每个函数定义结束之后都要加空行。参见示例2-1（a）  
    * `【规则2-1-2】`在一个函数体内，逻揖上密切相关的语句之间不加空行，其它地方应加空行分隔。参见示例2-1（b ）

示例2-1(a) 函数之间的空行
```php
// 空行
function function1(…)
{
  …
}

// 空行
function function2(…)
{
  …
}

// 空行
function function3(…)
{
  …
}
```

示例2-1(b) 函数内部的空行    
 ```php
 // 空行
while (condition) {
    statement1;
    // 空行
    if (condition) {
        statement2;
    } else {
        statement3;
    }
    // 空行
    statement4;
}  
```

### 代码行

`【规则2-2-1】`  一行代码只做一件事情，如只定义一个变量，或只写一条语句。这样的代码容易阅读，并且方便于写注释。  
`【规则2-2-2】` if、for、while、do等语句自占一行，执行语句不得紧跟其后。不论执行语句有多少都要加{}。这样可以防止书写失误， {保持在同一行。   
示例2-2（a）为风格良好的代码行，示例2-2（b）为风格不良的代码行。

示例2-2(a) 风格良好的代码行 
```php
$width = 100;     // 宽度
$height = 100;     // 高度
$depth = 200;     // 深度

$x = $a + $b;
$y = $c + $d;
$z = $e + $f;

if ($width < $height) {
    dosomething();
}

for (initialization; condition; update) {
    dosomething();
}

// 空行
other();
```

示例2-2(b) 风格不良的代码行
```php
$width, $height, $depth; // 宽度高度深度
$X ＝ $a + $b;   $y = $c + $d;  $z = $e + $f;
if ($width < $height) dosomething();
for (initialization; condition; update)
    dosomething();
other();
```

`【建议2-2-3】` 尽量在定义变量的同时初始化该变量（就近原则）
如果变量的引用处和其定义处相隔比较远，变量的初始化很容易被忘记。如果引用了未被初始化的变量，可能会导致程序错误。本建议可以减少隐患。例如:
```php
$width = 10;    // 定义并初绐化width 
$height = 10;   // 定义并初绐化height 
$depth = 10;    // 定义并初绐化depth 
```

### 代码行内的空格

`【规则2-3-1】`关键字之后要留空格。象`const`、`use` 等关键字之后至少要留一个空格，否则无法辨析关键字。象`if`、`for`、`while`等关键字之后应留一个空格再跟左括号‘（’，以突出关键字。

`【规则2-3-2】`函数名之后不要留空格，紧跟左括号‘（’，以与关键字区别。

`【规则2-3-3】` ‘（’向后紧跟，‘）’、‘，’、‘;’向前紧跟，紧跟处不留空格。

`【规则2-3-4】` `,`之后要留空格，如Function(x, y, z)。如果`;`不是一行的结束符号，其后要留空格，如`for (initialization; condition; update)`。

`【规则2-3-5】` 赋值操作符、比较操作符、算术操作符、逻辑操作符、位域操作符，如`=`、`+=` `>=`、`<=`、`+`、`*`、`%`、`&&`、`||`、`<<`,`^`等二元操作符的前后应当加空格。

`【规则2-3-6】` 一元操作符如`!`、`~`、`++`、`--`、`&`（地址运算符）等前后不加空格。

`【规则2-3-7】` 象`[]`,`.`, `->`这类操作符前后不加空格。

`【建议2-3-1】`对于表达式比较长的for语句和if语句，为了紧凑起见可以适当地去掉一些空格，如`for (i = 0; i < 10; i++)和if ((a <= b) && (c <= d))`


示例2-3 代码行内的空格
```php
function Func1(int $x, int $y, int $z);          // 良好的风格
function Func1 (int $x,int $y,int $z);           // 不良的风格

if ($year >= 2000)                         // 良好的风格
if($year>=2000)                            // 不良的风格

if (($a >= b) && ($c <= $d))                     // 良好的风格
if($a>=$b&&$c<=$d)                            // 不良的风格 

for ($i = 0; $i < 10; $i++)                      // 良好的风格
for($i=0;$i<10;$i++)                         // 不良的风格
for ($i = 0; $i < 10; $i ++)                 // 过多的空格
 
x = $a < $b ? a : b;                        // 良好的风格
x=$a<$b?$a:$b;                                // 不好的风格
$x = &$y;                              // 良好的风格  
$x = & $y;                            // 不良的风格 

$array[5] = 0;                             // 不要写成 $array [ 5 ] = 0;
$a->Function();                          // 不要写成 $a -> Function();
$b->Function();                          // 不要写成 $b -> Function();
```

### 对齐


`【规则2-4-1】` 程序的命名空间,类，函数，成员函数，分界符`{`和`}`应独占一行并且位于同一列，同时与引用它们的语句左对齐。
`【规则2-4-2】` 程序的逻辑控制结构体，如if, else, switch, while等，分界符 `{` 与上一行位于同一行，`}`应独占一行并且位于同一列，同时与引用它们的语句左对齐。
`【规则2-4-3】` { }之内的代码块在`{`右边数格处左对齐。
示例2-4(a) 风格良好的对齐   
```php
function Function($x)
{
    … // program code
}

if (condition) {
    … // program code
} else {
    … // program code
}

for (initialization; condition; update) {
    … // program code
}

while (condition) {
    … // program code
}

// 如果出现嵌套的｛｝，则使用缩进对齐，如：
{
    …
    {
        …
    }
     …
}
```

示例2-4(b) 风格不良的对齐
```php
function Function($x){
    … // program code
}

if (condition)
{
    … // program code
}
else 
{
    … // program code
}

for (initialization; condition; update) 
{
    … // program code
}

while (condition)
{
    … // program code
}
```

### 长行拆分

`【规则2-5-1】` 代码行最大长度宜控制在70至80个字符以内。代码行不要过长，否则眼睛看不过来，也不便于打印。
`【规则2-5-2】` 长表达式要在低优先级操作符处拆分成新行，操作符放在新行之首（以便突出操作符）。拆分出的新行要进行适当的缩进，使排版整齐，语句可读。

示例2-5 长行的拆分
```php
if (($veryLongerVariable1 >= $veryLongerVariable12)
&& ($veryLongerVariable3 <= $veryLongerVariable14)
&& ($veryLongerVariable5 <= $veryLongerVariable16))
{
    dosomething();
}
 
for ($veryLongerInitialization;
     $veryLongerCondition;
     $veryLongerUpdate)
{
    dosomething();
}
```

### 修饰符的位置

`【规则2-6-1】` 修饰符`＆`应该靠近变量名。


### 注释
C语言的注释符为“/*…*/”。C++语言中，程序块的注释常采用“/*…*/”，行注释一般采用“//…”。注释通常用于：
（1）版本、版权声明；
（2）函数接口说明；
（3）重要的代码行或段落提示。

虽然注释有助于理解代码，但注意不可过多地使用注释。参见示例2-6。

【规则2-7-1】注释是对代码的“提示”，而不是文档。程序中的注释不可喧宾夺主，注释太多了会让人眼花缭乱。注释的花样要少。

【规则2-7-2】如果代码本来就是清楚的，则不必加注释。否则多此一举，令人厌烦。例如:

```php    
$i++;   // i 加 1，多余的注释 
```

【规则2-7-3】边写代码边注释，修改代码同时修改相应的注释，以保证注释与代码的一致性。不再有用的注释要删除。

【规则2-7-4】注释应当准确、易懂，防止注释有二义性。错误的注释不但无益反而有害。

【规则2-7-5】尽量避免在注释中使用缩写，特别是不常用缩写。

【规则2-7-6】注释的位置应与被描述的代码相邻，可以放在代码的上方或右方，不可放在下方。

【规则2-7-8】当代码比较长，特别是有多重嵌套时，应当在一些段落的结束处加注释，便于阅读。

示例2-6 程序的注释。

```php
/*
* [函数说明]
* @param int[参数类型] $x[参数名] 参数说明：
* @return [返回类型]
*/
function function($x,  $y,  $z)
{
    …
}

// 嵌套注释
if (…) {
    …
    while (…) {
        …
    }  // end of while
…
} // end of if
```

### 类的排版

类可以将数据和函数封装在一起，其中函数表示了类的行为（或称服务）。   
类提供关键字`public`、`protected`和`private`，分别用于声明哪些数据和函数是公有的、受保护的或者是私有的。这样可以达到信息隐藏的目的，即让类仅仅公开必须要让外界知道的内容，而隐藏其它一切内容。   
我们不可以滥用类的封装功能，不要把它当成火锅，什么东西都往里扔。    
类的版式主要有两种方式：  
*  将`private`类型的数据写在前面，而将`public`类型的函数写在后面，如示例8-3（a）。采用这种版式的程序员主张类的设计“以数据为中心”，重点关注类的内部结构。      
*  将`public`类型的函数写在前面，而将`private`类型的数据写在后面，如示例8.3（b）采用这种版式的程序员主张类的设计“以行为为中心”，重点关注的是类应该提供什么样的接口（或服务）。   
* 很多编程规范或者教材不知不觉地采用了`以数据为中心`的书写方式，并不见得有多少道理。

本规范采用`以行为为中心的`排版方式。
在团队协作里面，我们首先考虑类应该提供什么样的函数。这是很多人的经验：
“这样做不仅让自己在设计类时思路清晰，而且方便别人阅读。因为程序员最关心的是接口，谁都不愿意先看到一堆私有数据成员！”
示例2.7(a) 以数据为中心版式 
                    
```php
class A
{
    private  $width = 0;
    
    public  $height = 0;
}
```

示例2.7(b) 以行为为中心的版式

```php
class A
{
  public  $width;
  
  private  $height;    
  …
}
```

命名规则
----
-----

### 标识符

`【规则3-1-1】` 标识符应当直观且可以拼读，可望文知意，不必进行“解码”。 标识符最好采用英文单词或其组合，便于记忆和阅读。切忌使用汉语拼音来命名。程序中的英文单词一般不会太复杂，用词应当准确。例如不要把$currentValue写成$nowValue。  
   
`【规则3-1-2】` 标识符的长度应当符合“最小长度表达最多含义”的原则， 常见的如`i,j,k,m,n,x,y,z`等，通常可用作函数内的局部变量。   

`【规则3-1-3】` 命名规则采用“大小写”混排的方式，如addChild。而Unix应用程序的标识符通常采用“小写加下划线”的方式，如add_child。 别把这两类风格混在一起用，统一使用大小写混排的驼峰规范。     

`【规则3-1-4】`程序中不要出现仅靠大小写区分的相似的标识符。

例如：   

```php
$x,  $X;        // 变量x 与 X 容易混淆

function foo($x);   // 函数foo 与FOO容易混淆
function FOO($x);
```
 
`【规则3-1-5】` 程序中不要出现标识符完全相同的`局部变量`和`全局变量`，尽管两者的作用域不同而不会发生语法错误，但会使人误解。

`【规则3-1-6】` 变量的名字应当使用`名词`或者`形容词＋名词`。

例如：   

```php
$value;
$oldValue;
$newValue;
```
 
`【规则3-1-7】` 全局函数的名字应当使用`动词`或者`动词＋名词`（动宾词组）。类的成员函数应当尽量使用`动词`，被省略掉的名词就是对象本身。

例如：   

```php
drawBox();            // 全局函数
box->draw();         // 类的成员函数
```
 
`【规则3-1-8】` 用正确的反义词组命名具有互斥意义的变量或相反动作的函数等。

例如：

```php
$minValue;
$maxValue;
$setValue(…);
$getValue(…);
```

`【建议3-1-1】` 尽量避免名字中出现数字编号，如`Value1,Value2`等，除非逻辑上的确需要编号。


### 简单的PHP程序命名规则


`【规则3-2-1】`类名用大写字母开头的单词组合而成。
例如：

```php
  class Node;                 // 类名

  class LeafNode;             // 类名
```

`【规则3-2-2】`函数名用小写字母开头的单词组合而成。
例如：

```php
  function $node;                 // 函数名

  function $leafNode;             // 函数名
```

`【规则3-2-3】`变量和参数用小写字母开头的单词组合而成。
例如：

```php
    bool $flag;
    int $drawMode;
```

`【规则3-2-4】`常量全用大写的字母，用下划线分割单词。
例如：

```php
    define('MAX', 100);

    define('MAX_LINE', 100);
```

`【规则3-2-5】`如果不得已需要全局变量，则使全局变量加前缀g（表示global）。

例如：

```php
$gHowManyPeople;     // 全局变量

$gHowMuchMoney;     // 全局变量
```

`【规则3-2-6】`类的私有数据成员(`protected`, `private`)无需加前缀，这样可以避免数据成员与成员函数的参数同名。

例如：


```php
private $width = 0;

private $height = 0;

function setValue($width, $height)
{
  $this->width = width;
  $this->height = height;
}
```
 
`【规则3-2-7】`为了防止某一软件库中的一些标识符和其它软件库中的冲突，可以为各种标识符加上能反映软件性质的前缀。例如三维图形标准OpenGL的所有库函数均以gl开头，所有常量（或宏定义）均以GL开头。


表达式和基本语句
----
-----

### 运算符的优先级

PHP的运算符有数十个，运算符的优先级与结合律如表4-1所示。注意一元运算符 +  -  * 的优先级高于对应的二元运算符。

![表4-1 运算符的优先级与结合律](https://github.com/tinyphporg/tinyphp-docs/blob/master/docs/image/4.1.png)

`【规则4-1-1】` 如果代码行中的运算符比较多，用括号确定表达式的操作顺序，避免使用默认的优先级。

由于将表4-1熟记是比较困难的，为了防止产生歧义并提高可读性，应当用括号确定表达式的操作顺序。例如：


```php
$word = ($high + 8) * $low
if (($a == $b) && ($a != $c))
```

### 复合表达式

如 $a = $b = $c = 0这样的表达式称为复合表达式。允许复合表达式存在的理由是：（1）书写简洁；（2）可以提高编译效率。但要防止滥用复合表达式。
`【规则4-2-1】` 不要编写太复杂的复合表达式。
例如：

```php
$i = $a >=$b && $c < $d&& $c + $f <= $g + $h ; // 复合表达式过于复杂
```

`【规则4-2-2】` 不要有多用途的复合表达式。   
例如：

```php
$d = ($a = $b + $c) + $r ; 
```

该表达式既求a值又求d值。应该拆分为两个独立的语句：

```php
$a = $b + $c;
$d = $a + $r;
```
 
`【规则4-2-3】` 不要把程序中的复合表达式与“真正的数学表达式”混淆。
例如：  

```php
if ($a < $b < $c)           // a < b < c是数学表达式而不是程序表达式
```
并不表示       

```php
if (($a < $b) && $(b < $c))
```
而是成了令人费解的

```php
if ( ($a < $b) < $c )
```


### if 语句    


 if语句是PHP语言中最简单、最常用的语句，然而很多程序员用隐含错误的方式写if语句。本节以“与零值比较”为例，展开讨论。

 
#### 布尔变量与零值比较

`【规则4-3-1】` 不可将布尔变量直接与`true、false`或者`1、0`进行比较。
假设布尔变量名字为$flag`，它与零值比较的标准if语句如下：
    
```php
if ($flag)   //表示$flag为真
if (!$flag)  //表示$flag为假
```

其它的用法都属于不良风格，例如：

```php
    if ($flag == true)  

    if ($flag == 1 )        

    if ($flag == false)  

    if ($flag == 0)     
```
 
#### 整型变量与零值比较

`【规则4-3-2】`应当将整型变量用`==`或`!=`直接与0比较。
    假设整型变量的名字为`$value`，它与零值比较的标准if语句如下：
    
```php
if ($value == 0)  
if ($value != 0)
```

不可模仿布尔变量的风格而写成

```php
if ($value)    //会让人误解 $value是布尔变量

if (!$value) 
```

#### 浮点变量与零值比较

`【规则4-3-3】` 不可将浮点变量用`==`或`！=`与任何数字比较。
    千万要留意，无论是float还是double类型的变量，都有精度限制。所以一定要避免将浮点变量用`==`或`！=`与数字比较，应该设法转化成`>=`或`<=`形式。
    假设浮点变量的名字为x，应当将   
```php
if ($x == 0.0) // 隐含错误的比较
```

转化为 
```php
if (($x >= -EPSINON) && (x <= EPSINON))
```

其中EPSINON是允许的误差（即精度）。

#### 对if语句的补充说明

有时候我们可能会看到 if (null == p) 这样古怪的格式。不是程序写错了，是程序员为了防止将 if (p == null) 误写成 if (p = null)，而有意把p和null颠倒。编译器认为 if (p = null) 是合法的，但是会指出 if (null = p)是错误的，因为null不能被赋值。

程序中有时会遇到if/else/return的组合，应该将如下不良风格的程序
```php    

if ($condition) 
    return $x;
return $y;

```

改写为

```php

if ($condition) {
    return $x;
} else {
    return $y;
}
```

或者改写成更加简练的 

```php
return ($condition ? $x : $y);
```

### 循环语句的效率

PHP循环语句中，for/foreach语句使用频率最高，while语句其次，do语句很少用。本节重点论述循环体的效率。提高循环体效率的基本办法是降低循环体的复杂性。
`【建议4-4-1】`在多重循环中，如果有可能，应当将最长的循环放在最内层，最短的循环放在最外层，以减少CPU跨切循环层的次数。例如示例4-4(b)的效率比示例4-4(a)的高。

示例4-4(a) 低效率：长循环在最外层

```php

for ($row = 0; $row < 100; $row++) {
    for ($col = 0; $col < 5; $col++) {
        sum = $sum + $a[$row][$col];
    }
}

```

示例4-4(b) 高效率：长循环在最内层

```php
 for ($col = 0; $col < 5; $col++ ) {
    for ($row = 0;$ row < 100; $row++) {
        $sum = $sum + $a[$row][$col];
    }
}
```

`【建议4-4-2】` 如果循环体内存在逻辑判断，并且循环次数很大，宜将逻辑判断移到循环体的外面。
示例4-4(c)的程序比示例4-4(d)多执行了N-1次逻辑判断。并且由于前者老要进行逻辑判断，打断了循环“流水线”作业，使得编译器不能对循环进行优化处理，降低了效率。如果N非常大，
最好采用示例4-4(d)的写法，可以提高效率。如果N非常小，两者效率差别并不明显，采用示例4-4(c)的写法比较好，因为程序更加简洁。


表4-4(c) 效率低但程序简洁

```php
for ($i = 0; $i < N; $i++)
{
    if ($condition)
        doSomething();
    else
        doOtherthing();
}
```

表4-4(d) 效率高但程序不简洁

```php
if ($condition){
    for ($i = 0; $i < N; $i++)
        doSomething();
} else {
    for ($i = 0; $i < N; $i++)
        doOtherthing();
}
 ```

#### for 语句的循环控制变量

`【规则4-5-1】` 不可在for 循环体内修改循环变量，防止for 循环失去控制。
`【建议4-5-1】` 建议for语句的循环控制变量的取值采用“半开半闭区间”写法。
示例4-5(a)中的x值属于半开半闭区间“0 =< $x < $N”，起点到终点的间隔为N，循环次数为N。
示例4-5(b)中的x值属于闭区间“0 =< $x <= N-1”，起点到终点的间隔为N-1，循环次数为N。
相比之下，示例4-5(a)的写法更加直观，尽管两者的功能是相同的。
示例4-5(a) 循环变量属于半开半闭区间

```php
for ($x = 0; $x < N; $x++)
{
    …
}
```

示例4-5(b) 循环变量属于闭区间

```php
for ($x = 0; $x <= N-1; $x++)
{
    …
}
```

### switch语句

有了if语句为什么还要`switch`语句？
`switch`是多分支选择语句，而if语句只有两个分支可供选择。虽然可以用嵌套的if语句来实现多分支选择，但那样的程序冗长难读。这是`switch`语句存在的理由。
`switch`语句的基本格式是：

```php
switch ($variable)
{
    case $value1 : … 
    break;

case $value2 :… 
    break;
    …
    default :  … 
    break;
}
```
 
`【规则4-6-1】`每个case语句的结尾不要忘了加`break`，否则将导致多个分支重叠（除非有意使多个分支重叠）。
`【规则4-6-2】`不要忘记最后那个`default`分支。即使程序真的不需要`default`处理，也应该保留语句   “`default : break`;” 这样做并非多此一举，而是为了防止别人误以为你忘了`default`处理。
如果某个`case`分支语句过长，在`break`右侧应加上注释  /*jump into next*/


### goto语句

虽然`PHP`有`goto`语句， 本规范禁用。


常量
-----
-----
常量有两种形式：  
`全局常量`:用函数`define()`设置;
`命名空间和类内的常量`： 用关键字`const`设置。
 
### 常量的优势

如果不使用常量，直接在程序中填写数字或字符串，将会有什么麻烦？
* 程序的可读性（可理解性）变差。程序员自己会忘记那些数字或字符串是什么意思，用户则更加不知它们从何处来、表示什么。
* 在程序的很多地方输入同样的数字或字符串，难保不发生书写错误。
* 如果要修改数字或字符串，则会在很多地方改动，既麻烦又容易出错。

`【规则5-1-1】` 尽量使用含义直观的常量来表示那些将在程序中多次出现的数字或字符串。
例如：

```php    
    define（‘MAX’，   100）;        /* PHP的常量设置  */ 
```

### const 与 define的取舍

`【规则5-2-1】` 在大多数情况下，面向对象尽量使用const常量而不使用define常量，即const常量可完全取代define常量。

### 常量定义规则
`【规则5-3-1】` 将需要对外公开的常量放在入口文件中，不需要对外公开的常量放在文件的头部。为便于管理，可以把不同模块的常量集中存放在一个公共的文件中。
`【规则5-3-2】` 如果某一常量与其它常量密切相关，应在定义中包含这种关系，而不应给出一些孤立的值。

例如：

```php
define('RADIUS', 100);

define('DIAMETER', RADIUS * 2);
```

### 类中的常量

需在类声明中初始化const数据成员。   
类常量可以通过private protected限制作用域。

```php
class A
{
  …
  const SIZE = 100;   // 错误，企图在类声明中初始化const数据成员

}
```

函数设计
-----
-----

### 参数的规则

`【规则6-1-1】`参数的书写要完整，不要贪图省事。
`【规则6-1-2】`参数命名要恰当，顺序要合理。

例如编写字符串拷贝函数`stringCopy`，它有两个参数。如果把参数名字起为`$str1`和`$str2`，例如

```php
function stringCopy($str1, $str2);
```

那么我们很难搞清楚究竟是把str1拷贝到str2中，还是刚好倒过来。
可以把参数名字起得更有意义，如叫$strSource和$strDestination。这样从名字上就可以看出应该把$strSource拷贝到$strDestination。
还有一个问题，这两个参数那一个该在前那一个该在后？参数的顺序要遵循程序员的习惯。一般地，应将目的参数放在前面，源参数放在后面。
如果将函数声明为：

```php
function stringCopy($strSource, $strDestination);
```

别人在使用时可能会不假思索地写成如下形式：

```php
function stringCopy($str, “Hello World”); // 参数顺序颠倒
```

`【规则6-1-4】`在PHP里，对象的传递默认是以引用方式存在的，无需用& 。 
`【建议6-1-1】`避免函数有太多的参数，参数个数尽量控制在5个以内。如果参数太多，在使用时容易将参数类型或顺序搞错。
`【建议6-1-2】`尽量不要使用类型和数目不确定的参数。

printf是采用不确定参数的典型代表，其原型为：

```php 
printf(string …);
```
这种风格的函数在编译时丧失了严格的类型安全检查。

### 返回值的规则    
`【建议6-2-1】` 有时候函数原本不需要返回值，但为了增加灵活性如支持链式表达，可以附加返回值。
比如 

```php
function setTimezone()
{
  ……
  return $this;
}
```

### 函数内部实现的规则

不同功能的函数其内部实现各不相同，看起来似乎无法就“内部实现”达成一致的观点。但根据经验，我们可以在函数体的“入口处”和“出口处”从严把关，从而提高函数的质量。
`【规则6-3-1】`在函数体的“入口处”，对参数的有效性进行检查。
很多程序错误是由非法参数引起的

`【规则6-3-2】`在函数体的“出口处”，对return语句的正确性和效率进行检查。
如果函数有返回值，那么函数的“出口处”是return语句。我们不要轻视return语句。如果return语句写得不好，函数要么出错，要么效率低下。

### 其它建议

`【建议6-4-1】`函数的功能要单一，不要设计多用途的函数。
`【建议6-4-2】`函数体的规模要小，尽量控制在50行代码之内。
`【建议6-4-3】`尽量避免函数带有“记忆”功能。相同的输入应当产生相同的输出。
带有“记忆”功能的函数，其行为可能是不可预测的，因为它的行为可能取决于某种“记忆状态”。这样的函数既不易理解又不利于测试和维护。函数的`static`局部变量是函数的“记忆”存储器。建议尽量少用`static`局部变量，除非必需。
`【建议6-4-4】`不仅要检查输入参数的有效性，还要检查通过其它途径进入函数体内的变量的有效性，例如全局变量、文件句柄等。
`【建议6-4-5】`用于出错处理的返回值一定要清楚，让使用者不容易忽视或误解错误情况。


IDE的选择
-----
-----

IDE及其他在编程过程中使用的工具，都需要符合现代生产的要求：`易用，简单、高效`。
对个人而言，在学习中可以选择没有代码提示，没有模板，没有各种各样快捷操作方式的编辑器，比如`文本编辑器`，甚至`记事本`、`写字板`等。
这对强化自身对语法的记忆，对函数、各种语法的掌握有一定的加强作用。
但并不需要带到工作当中，乃至团队合作中去。
一个团队最好能统一使用一种简单、快捷，好用的IDE，比如`Zend Studio`, `Ecplise`、`Netbeans`, `PHPStdio`, `idea`等，以最大化的提高生产效率，在每个人在开发过程中，可以针对不同的开发环境配备多种不同的IDE，达到开发效率最大化。
在团队开发效率和自身使用习惯冲突时，不要固守连自动完成、自动对齐和格式化代码都没有的文本编辑器，谨慎使用VIM那种需要大量个性化配置和自定义的编辑器。
程序员是极具个性的动物，但团队合作只需要恰当好处的个性，个人需要服从于集体。
本规范使用IDE 为Ecplise

### 编码规范的一些示例

示例8-1 完整的类文件

```php
<?php
/**
 * #本文件内的一些简短介绍
 *
 * @Copyright (C), 2011-, King.  
 * @Name Example.php   #文件名需与类名相同
 * @Author King #此处写上作者大名，是开发者的签名，也可以在第一时间追查出BUG出自何人之手。
 * @Version Beta 1.1  #当前的版本号
 * @Date: 2012-2-2    #创建的日期     
 * @Class List
 * 1. Example  示范例子   #将本文件夹内的类做简短的功能介绍和定位
 * @Function List
 * 1.                   
 * @History    #记录该类所有的修改历史
 * <author> <time> <version > <desc>    
 * King 2012-2-2 Beta 1.0 第一次建立该文件
  * King  2013-2-2 Beta1.1 修改文件，增加函数out       
 */
namespace Tiny;  // 命名空间需要放置在所有代码前面，declare除外。

/**
*   #类的简短介绍
*
* @example #类的使用示例介绍
* @package  #所属命名空间或者包内
* @since      #起始时间
* @final       #最终修改时间
*/
class Example
{
    /**
     *  防暴力破解的加密KEY
     *
     * @var string 默认的字符串
     */
     private static $key = 'TINY';
    
    /**
     * 解密函数
     *
     * @param string $string 需要输出的字符
     * @return string
     */
    public static function out($string = NULL)
    {
        return (is_null($string) ? self::$key : $string);
    }
    
?>  
```

为了代码的完整性，需要闭合PHP标签
示例8-2 循环的一些示例

```php
for ($i = 0; $i < 100; $i++) {
     ……;
}
```
